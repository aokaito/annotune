{
    "Resources": {
        "LyricsTableFE171BED": {
            "Type": "AWS::DynamoDB::Table",
            "Properties": {
                "AttributeDefinitions": [
                    {
                        "AttributeName": "docId",
                        "AttributeType": "S"
                    },
                    {
                        "AttributeName": "ownerId",
                        "AttributeType": "S"
                    }
                ],
                "BillingMode": "PAY_PER_REQUEST",
                "GlobalSecondaryIndexes": [
                    {
                        "IndexName": "ownerId-index",
                        "KeySchema": [
                            {
                                "AttributeName": "ownerId",
                                "KeyType": "HASH"
                            }
                        ],
                        "Projection": {
                            "ProjectionType": "ALL"
                        }
                    }
                ],
                "KeySchema": [
                    {
                        "AttributeName": "docId",
                        "KeyType": "HASH"
                    }
                ],
                "PointInTimeRecoverySpecification": {
                    "PointInTimeRecoveryEnabled": true
                },
                "TableName": "AnnotuneLyrics"
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/LyricsTable/Resource"
            }
        },
        "AnnotationsTableA677432B": {
            "Type": "AWS::DynamoDB::Table",
            "Properties": {
                "AttributeDefinitions": [
                    {
                        "AttributeName": "docId",
                        "AttributeType": "S"
                    },
                    {
                        "AttributeName": "annotationId",
                        "AttributeType": "S"
                    }
                ],
                "BillingMode": "PAY_PER_REQUEST",
                "KeySchema": [
                    {
                        "AttributeName": "docId",
                        "KeyType": "HASH"
                    },
                    {
                        "AttributeName": "annotationId",
                        "KeyType": "RANGE"
                    }
                ],
                "TableName": "AnnotuneAnnotations"
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotationsTable/Resource"
            }
        },
        "VersionsTable23B78FD4": {
            "Type": "AWS::DynamoDB::Table",
            "Properties": {
                "AttributeDefinitions": [
                    {
                        "AttributeName": "docId",
                        "AttributeType": "S"
                    },
                    {
                        "AttributeName": "version",
                        "AttributeType": "N"
                    }
                ],
                "BillingMode": "PAY_PER_REQUEST",
                "KeySchema": [
                    {
                        "AttributeName": "docId",
                        "KeyType": "HASH"
                    },
                    {
                        "AttributeName": "version",
                        "KeyType": "RANGE"
                    }
                ],
                "TableName": "AnnotuneDocVersions"
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/VersionsTable/Resource"
            }
        },
        "AnnotuneUserPool1679AB31": {
            "Type": "AWS::Cognito::UserPool",
            "Properties": {
                "AccountRecoverySetting": {
                    "RecoveryMechanisms": [
                        {
                            "Name": "verified_email",
                            "Priority": 1
                        }
                    ]
                },
                "AdminCreateUserConfig": {
                    "AllowAdminCreateUserOnly": false
                },
                "AutoVerifiedAttributes": [
                    "email"
                ],
                "EmailVerificationMessage": "The verification code to your new account is {####}",
                "EmailVerificationSubject": "Verify your new account",
                "SmsVerificationMessage": "The verification code to your new account is {####}",
                "UsernameAttributes": [
                    "email"
                ],
                "VerificationMessageTemplate": {
                    "DefaultEmailOption": "CONFIRM_WITH_CODE",
                    "EmailMessage": "The verification code to your new account is {####}",
                    "EmailSubject": "Verify your new account",
                    "SmsMessage": "The verification code to your new account is {####}"
                }
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneUserPool/Resource"
            }
        },
        "AnnotuneUserPoolClient3F26C5A1": {
            "Type": "AWS::Cognito::UserPoolClient",
            "Properties": {
                "AllowedOAuthFlows": [
                    "implicit",
                    "code"
                ],
                "AllowedOAuthFlowsUserPoolClient": true,
                "AllowedOAuthScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "CallbackURLs": [
                    "https://example.com"
                ],
                "GenerateSecret": false,
                "PreventUserExistenceErrors": "ENABLED",
                "SupportedIdentityProviders": [
                    "COGNITO"
                ],
                "UserPoolId": {
                    "Ref": "AnnotuneUserPool1679AB31"
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneUserPoolClient/Resource"
            }
        },
        "AnnotuneApiHandlerServiceRoleB20BF8E2": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneApiHandler/ServiceRole/Resource"
            }
        },
        "AnnotuneApiHandlerServiceRoleDefaultPolicyDDB312D0": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "dynamodb:BatchGetItem",
                                "dynamodb:GetRecords",
                                "dynamodb:GetShardIterator",
                                "dynamodb:Query",
                                "dynamodb:GetItem",
                                "dynamodb:Scan",
                                "dynamodb:ConditionCheckItem",
                                "dynamodb:BatchWriteItem",
                                "dynamodb:PutItem",
                                "dynamodb:UpdateItem",
                                "dynamodb:DeleteItem",
                                "dynamodb:DescribeTable"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "LyricsTableFE171BED",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "LyricsTableFE171BED",
                                                    "Arn"
                                                ]
                                            },
                                            "/index/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": [
                                "dynamodb:BatchGetItem",
                                "dynamodb:GetRecords",
                                "dynamodb:GetShardIterator",
                                "dynamodb:Query",
                                "dynamodb:GetItem",
                                "dynamodb:Scan",
                                "dynamodb:ConditionCheckItem",
                                "dynamodb:BatchWriteItem",
                                "dynamodb:PutItem",
                                "dynamodb:UpdateItem",
                                "dynamodb:DeleteItem",
                                "dynamodb:DescribeTable"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "AnnotationsTableA677432B",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Ref": "AWS::NoValue"
                                }
                            ]
                        },
                        {
                            "Action": [
                                "dynamodb:BatchGetItem",
                                "dynamodb:GetRecords",
                                "dynamodb:GetShardIterator",
                                "dynamodb:Query",
                                "dynamodb:GetItem",
                                "dynamodb:Scan",
                                "dynamodb:ConditionCheckItem",
                                "dynamodb:BatchWriteItem",
                                "dynamodb:PutItem",
                                "dynamodb:UpdateItem",
                                "dynamodb:DeleteItem",
                                "dynamodb:DescribeTable"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "VersionsTable23B78FD4",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Ref": "AWS::NoValue"
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "AnnotuneApiHandlerServiceRoleDefaultPolicyDDB312D0",
                "Roles": [
                    {
                        "Ref": "AnnotuneApiHandlerServiceRoleB20BF8E2"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneApiHandler/ServiceRole/DefaultPolicy/Resource"
            }
        },
        "AnnotuneApiHandler817BBC45": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "cdk-hnb659fds-assets-390403894106-ap-northeast-1",
                    "S3Key": "26bcf12f1377320ff5388e86fd6d81d88d9cafb5dee941fd77b4ec97635a223d.zip"
                },
                "Environment": {
                    "Variables": {
                        "LYRICS_TABLE_NAME": {
                            "Ref": "LyricsTableFE171BED"
                        },
                        "LYRICS_OWNER_INDEX_NAME": "ownerId-index",
                        "ANNOTATIONS_TABLE_NAME": {
                            "Ref": "AnnotationsTableA677432B"
                        },
                        "VERSIONS_TABLE_NAME": {
                            "Ref": "VersionsTable23B78FD4"
                        },
                        "ALLOWED_ORIGIN": "*"
                    }
                },
                "Handler": "index.handler",
                "MemorySize": 512,
                "Role": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandlerServiceRoleB20BF8E2",
                        "Arn"
                    ]
                },
                "Runtime": "nodejs20.x",
                "Timeout": 10
            },
            "DependsOn": [
                "AnnotuneApiHandlerServiceRoleDefaultPolicyDDB312D0",
                "AnnotuneApiHandlerServiceRoleB20BF8E2"
            ],
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneApiHandler/Resource",
                "aws:asset:path": "asset.26bcf12f1377320ff5388e86fd6d81d88d9cafb5dee941fd77b4ec97635a223d",
                "aws:asset:is-bundled": true,
                "aws:asset:property": "Code"
            }
        },
        "AnnotuneHttpApiBEB270CD": {
            "Type": "AWS::ApiGatewayV2::Api",
            "Properties": {
                "CorsConfiguration": {
                    "AllowHeaders": [
                        "Authorization",
                        "Content-Type",
                        "X-Doc-Version"
                    ],
                    "AllowMethods": [
                        "GET",
                        "POST",
                        "PUT",
                        "DELETE",
                        "OPTIONS"
                    ],
                    "AllowOrigins": [
                        "*"
                    ],
                    "MaxAge": 86400
                },
                "Name": "AnnotuneHttpApi",
                "ProtocolType": "HTTP"
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/Resource"
            }
        },
        "AnnotuneHttpApiDefaultStage9110AEAC": {
            "Type": "AWS::ApiGatewayV2::Stage",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AutoDeploy": true,
                "StageName": "$default"
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/DefaultStage/Resource"
            }
        },
        "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739": {
            "Type": "AWS::ApiGatewayV2::Integration",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "IntegrationType": "AWS_PROXY",
                "IntegrationUri": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "PayloadFormatVersion": "2.0"
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/POST--v1--lyrics/AnnotuneIntegration/Resource"
            }
        },
        "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegrationPermissionA7AA7AFB": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/POST--v1--lyrics/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiPOSTv1lyricsAFDC165C": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "POST /v1/lyrics",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/POST--v1--lyrics/Resource"
            }
        },
        "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95": {
            "Type": "AWS::ApiGatewayV2::Authorizer",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizerType": "JWT",
                "IdentitySource": [
                    "$request.header.Authorization"
                ],
                "JwtConfiguration": {
                    "Audience": [
                        {
                            "Ref": "AnnotuneUserPoolClient3F26C5A1"
                        }
                    ],
                    "Issuer": {
                        "Fn::Join": [
                            "",
                            [
                                "https://cognito-idp.ap-northeast-1.amazonaws.com/",
                                {
                                    "Ref": "AnnotuneUserPool1679AB31"
                                }
                            ]
                        ]
                    }
                },
                "Name": "AnnotuneAuthorizer"
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/AnnotuneAuthorizer/Resource"
            }
        },
        "AnnotuneHttpApiGETv1lyricsAnnotuneIntegrationPermissionF6926A82": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiGETv1lyrics153C585D": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "GET /v1/lyrics",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics/Resource"
            }
        },
        "AnnotuneHttpApiGETv1lyricsdocIdAnnotuneIntegrationPermission7765E2E6": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics--{docId}/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiGETv1lyricsdocId1C28D4BD": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "GET /v1/lyrics/{docId}",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics--{docId}/Resource"
            }
        },
        "AnnotuneHttpApiPUTv1lyricsdocIdAnnotuneIntegrationPermission97B435E3": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/PUT--v1--lyrics--{docId}/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiPUTv1lyricsdocId5587A28F": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "PUT /v1/lyrics/{docId}",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/PUT--v1--lyrics--{docId}/Resource"
            }
        },
        "AnnotuneHttpApiDELETEv1lyricsdocIdAnnotuneIntegrationPermission1DFA27D4": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/DELETE--v1--lyrics--{docId}/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiDELETEv1lyricsdocId3D4FB9B1": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "DELETE /v1/lyrics/{docId}",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/DELETE--v1--lyrics--{docId}/Resource"
            }
        },
        "AnnotuneHttpApiPOSTv1lyricsdocIdshareAnnotuneIntegrationPermissionA1B70FA1": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}/share"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/POST--v1--lyrics--{docId}--share/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiPOSTv1lyricsdocIdshare0BBABD0E": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "POST /v1/lyrics/{docId}/share",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/POST--v1--lyrics--{docId}--share/Resource"
            }
        },
        "AnnotuneHttpApiPOSTv1lyricsdocIdannotationsAnnotuneIntegrationPermissionEB4A9508": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}/annotations"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/POST--v1--lyrics--{docId}--annotations/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiPOSTv1lyricsdocIdannotations16495B3E": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "POST /v1/lyrics/{docId}/annotations",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/POST--v1--lyrics--{docId}--annotations/Resource"
            }
        },
        "AnnotuneHttpApiPUTv1lyricsdocIdannotationsannotationIdAnnotuneIntegrationPermission7501B554": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}/annotations/{annotationId}"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/PUT--v1--lyrics--{docId}--annotations--{annotationId}/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiPUTv1lyricsdocIdannotationsannotationId9BABA435": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "PUT /v1/lyrics/{docId}/annotations/{annotationId}",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/PUT--v1--lyrics--{docId}--annotations--{annotationId}/Resource"
            }
        },
        "AnnotuneHttpApiDELETEv1lyricsdocIdannotationsannotationIdAnnotuneIntegrationPermissionA64C4FA5": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}/annotations/{annotationId}"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/DELETE--v1--lyrics--{docId}--annotations--{annotationId}/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiDELETEv1lyricsdocIdannotationsannotationId0C43B0EC": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "DELETE /v1/lyrics/{docId}/annotations/{annotationId}",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/DELETE--v1--lyrics--{docId}--annotations--{annotationId}/Resource"
            }
        },
        "AnnotuneHttpApiGETv1lyricsdocIdversionsAnnotuneIntegrationPermission9076A23F": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}/versions"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics--{docId}--versions/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiGETv1lyricsdocIdversionsD818B7D7": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "GET /v1/lyrics/{docId}/versions",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics--{docId}--versions/Resource"
            }
        },
        "AnnotuneHttpApiGETv1lyricsdocIdversionsversionAnnotuneIntegrationPermissionD13C16A7": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/lyrics/{docId}/versions/{version}"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics--{docId}--versions--{version}/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiGETv1lyricsdocIdversionsversion366C1BE2": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationScopes": [
                    "openid",
                    "email",
                    "profile"
                ],
                "AuthorizationType": "JWT",
                "AuthorizerId": {
                    "Ref": "AnnotuneHttpApiAnnotuneAuthorizerE0EB0A95"
                },
                "RouteKey": "GET /v1/lyrics/{docId}/versions/{version}",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--lyrics--{docId}--versions--{version}/Resource"
            }
        },
        "AnnotuneHttpApiGETv1publiclyricsAnnotuneIntegrationPermissionCE6DD7DB": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/public/lyrics"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--public--lyrics/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiGETv1publiclyrics9FC65ED8": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationType": "NONE",
                "RouteKey": "GET /v1/public/lyrics",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--public--lyrics/Resource"
            }
        },
        "AnnotuneHttpApiGETv1publiclyricsdocIdAnnotuneIntegrationPermission12559DD2": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "AnnotuneApiHandler817BBC45",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:ap-northeast-1:390403894106:",
                            {
                                "Ref": "AnnotuneHttpApiBEB270CD"
                            },
                            "/*/*/v1/public/lyrics/{docId}"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--public--lyrics--{docId}/AnnotuneIntegration-Permission"
            }
        },
        "AnnotuneHttpApiGETv1publiclyricsdocIdE1277C0C": {
            "Type": "AWS::ApiGatewayV2::Route",
            "Properties": {
                "ApiId": {
                    "Ref": "AnnotuneHttpApiBEB270CD"
                },
                "AuthorizationType": "NONE",
                "RouteKey": "GET /v1/public/lyrics/{docId}",
                "Target": {
                    "Fn::Join": [
                        "",
                        [
                            "integrations/",
                            {
                                "Ref": "AnnotuneHttpApiPOSTv1lyricsAnnotuneIntegration299B1739"
                            }
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneHttpApi/GET--v1--public--lyrics--{docId}/Resource"
            }
        },
        "AnnotuneWebBucketB7EF974F": {
            "Type": "AWS::S3::Bucket",
            "Properties": {
                "PublicAccessBlockConfiguration": {
                    "BlockPublicAcls": true,
                    "BlockPublicPolicy": true,
                    "IgnorePublicAcls": true,
                    "RestrictPublicBuckets": true
                },
                "Tags": [
                    {
                        "Key": "aws-cdk:auto-delete-objects",
                        "Value": "true"
                    },
                    {
                        "Key": "aws-cdk:cr-owned:4b99a032",
                        "Value": "true"
                    }
                ]
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneWebBucket/Resource"
            }
        },
        "AnnotuneWebBucketPolicy13205BD6": {
            "Type": "AWS::S3::BucketPolicy",
            "Properties": {
                "Bucket": {
                    "Ref": "AnnotuneWebBucketB7EF974F"
                },
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": "s3:*",
                            "Condition": {
                                "Bool": {
                                    "aws:SecureTransport": "false"
                                }
                            },
                            "Effect": "Deny",
                            "Principal": {
                                "AWS": "*"
                            },
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "AnnotuneWebBucketB7EF974F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "AnnotuneWebBucketB7EF974F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": [
                                "s3:PutBucketPolicy",
                                "s3:GetBucket*",
                                "s3:List*",
                                "s3:DeleteObject*"
                            ],
                            "Effect": "Allow",
                            "Principal": {
                                "AWS": {
                                    "Fn::GetAtt": [
                                        "CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092",
                                        "Arn"
                                    ]
                                }
                            },
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "AnnotuneWebBucketB7EF974F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "AnnotuneWebBucketB7EF974F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Principal": {
                                "CanonicalUser": {
                                    "Fn::GetAtt": [
                                        "AnnotuneOAI7A09CFC4",
                                        "S3CanonicalUserId"
                                    ]
                                }
                            },
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "AnnotuneWebBucketB7EF974F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "AnnotuneWebBucketB7EF974F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "s3:GetObject",
                            "Effect": "Allow",
                            "Principal": {
                                "CanonicalUser": {
                                    "Fn::GetAtt": [
                                        "AnnotuneOAI7A09CFC4",
                                        "S3CanonicalUserId"
                                    ]
                                }
                            },
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        {
                                            "Fn::GetAtt": [
                                                "AnnotuneWebBucketB7EF974F",
                                                "Arn"
                                            ]
                                        },
                                        "/*"
                                    ]
                                ]
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneWebBucket/Policy/Resource"
            }
        },
        "AnnotuneWebBucketAutoDeleteObjectsCustomResource83B517DF": {
            "Type": "Custom::S3AutoDeleteObjects",
            "Properties": {
                "ServiceToken": {
                    "Fn::GetAtt": [
                        "CustomS3AutoDeleteObjectsCustomResourceProviderHandler9D90184F",
                        "Arn"
                    ]
                },
                "BucketName": {
                    "Ref": "AnnotuneWebBucketB7EF974F"
                }
            },
            "DependsOn": [
                "AnnotuneWebBucketPolicy13205BD6"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneWebBucket/AutoDeleteObjectsCustomResource/Default"
            }
        },
        "CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ]
                },
                "ManagedPolicyArns": [
                    {
                        "Fn::Sub": "arn:${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role"
            }
        },
        "CustomS3AutoDeleteObjectsCustomResourceProviderHandler9D90184F": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "cdk-hnb659fds-assets-390403894106-ap-northeast-1",
                    "S3Key": "faa95a81ae7d7373f3e1f242268f904eb748d8d0fdd306e8a6fe515a1905a7d6.zip"
                },
                "Timeout": 900,
                "MemorySize": 128,
                "Handler": "index.handler",
                "Role": {
                    "Fn::GetAtt": [
                        "CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092",
                        "Arn"
                    ]
                },
                "Runtime": "nodejs22.x",
                "Description": {
                    "Fn::Join": [
                        "",
                        [
                            "Lambda function for auto-deleting objects in ",
                            {
                                "Ref": "AnnotuneWebBucketB7EF974F"
                            },
                            " S3 bucket."
                        ]
                    ]
                }
            },
            "DependsOn": [
                "CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092"
            ],
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler",
                "aws:asset:path": "asset.faa95a81ae7d7373f3e1f242268f904eb748d8d0fdd306e8a6fe515a1905a7d6",
                "aws:asset:property": "Code"
            }
        },
        "AnnotuneOAI7A09CFC4": {
            "Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity",
            "Properties": {
                "CloudFrontOriginAccessIdentityConfig": {
                    "Comment": "Allows CloudFront to reach the bucket"
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneOAI/Resource"
            }
        },
        "AnnotuneDistribution14406537": {
            "Type": "AWS::CloudFront::Distribution",
            "Properties": {
                "DistributionConfig": {
                    "DefaultCacheBehavior": {
                        "AllowedMethods": [
                            "GET",
                            "HEAD",
                            "OPTIONS"
                        ],
                        "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
                        "Compress": true,
                        "TargetOriginId": "AnnotuneStackAnnotuneDistributionOrigin152CA86E9",
                        "ViewerProtocolPolicy": "redirect-to-https"
                    },
                    "DefaultRootObject": "index.html",
                    "Enabled": true,
                    "HttpVersion": "http2",
                    "IPV6Enabled": true,
                    "Origins": [
                        {
                            "DomainName": {
                                "Fn::GetAtt": [
                                    "AnnotuneWebBucketB7EF974F",
                                    "RegionalDomainName"
                                ]
                            },
                            "Id": "AnnotuneStackAnnotuneDistributionOrigin152CA86E9",
                            "S3OriginConfig": {
                                "OriginAccessIdentity": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "origin-access-identity/cloudfront/",
                                            {
                                                "Ref": "AnnotuneOAI7A09CFC4"
                                            }
                                        ]
                                    ]
                                }
                            }
                        }
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneDistribution/Resource"
            }
        },
        "AnnotuneBucketDeploymentAwsCliLayerDD7BD886": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "cdk-hnb659fds-assets-390403894106-ap-northeast-1",
                    "S3Key": "c49d356cac773d491c5f7ac148995a1181498a8e289429f8612a7f7e3814f535.zip"
                },
                "Description": "/opt/awscli/aws"
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneBucketDeployment/AwsCliLayer/Resource",
                "aws:asset:path": "asset.c49d356cac773d491c5f7ac148995a1181498a8e289429f8612a7f7e3814f535.zip",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "AnnotuneBucketDeploymentCustomResource45B45186": {
            "Type": "Custom::CDKBucketDeployment",
            "Properties": {
                "ServiceToken": {
                    "Fn::GetAtt": [
                        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536",
                        "Arn"
                    ]
                },
                "SourceBucketNames": [
                    "cdk-hnb659fds-assets-390403894106-ap-northeast-1"
                ],
                "SourceObjectKeys": [
                    "106144c3748bdd0434b73d3f4de0b430fe7cbb893e9e54a58cd4ec2faf95e7e8.zip"
                ],
                "DestinationBucketName": {
                    "Ref": "AnnotuneWebBucketB7EF974F"
                },
                "WaitForDistributionInvalidation": true,
                "Prune": true,
                "DistributionId": {
                    "Ref": "AnnotuneDistribution14406537"
                },
                "DistributionPaths": [
                    "/*"
                ],
                "OutputObjectKeys": true
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/AnnotuneBucketDeployment/CustomResource/Default"
            }
        },
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/Resource"
            }
        },
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:",
                                            {
                                                "Ref": "AWS::Partition"
                                            },
                                            ":s3:::cdk-hnb659fds-assets-390403894106-ap-northeast-1"
                                        ]
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:",
                                            {
                                                "Ref": "AWS::Partition"
                                            },
                                            ":s3:::cdk-hnb659fds-assets-390403894106-ap-northeast-1/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*",
                                "s3:DeleteObject*",
                                "s3:PutObject",
                                "s3:PutObjectLegalHold",
                                "s3:PutObjectRetention",
                                "s3:PutObjectTagging",
                                "s3:PutObjectVersionTagging",
                                "s3:Abort*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "AnnotuneWebBucketB7EF974F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "AnnotuneWebBucketB7EF974F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": [
                                "cloudfront:GetInvalidation",
                                "cloudfront:CreateInvalidation"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
                "Roles": [
                    {
                        "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy/Resource"
            }
        },
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "cdk-hnb659fds-assets-390403894106-ap-northeast-1",
                    "S3Key": "3423a042b818e31c1e34a19d6689ab2e5f9b70fcbe9e71df66f241b20a200bd9.zip"
                },
                "Environment": {
                    "Variables": {
                        "AWS_CA_BUNDLE": "/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem"
                    }
                },
                "Handler": "index.handler",
                "Layers": [
                    {
                        "Ref": "AnnotuneBucketDeploymentAwsCliLayerDD7BD886"
                    }
                ],
                "Role": {
                    "Fn::GetAtt": [
                        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
                        "Arn"
                    ]
                },
                "Runtime": "python3.13",
                "Timeout": 900
            },
            "DependsOn": [
                "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
                "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265"
            ],
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Resource",
                "aws:asset:path": "asset.3423a042b818e31c1e34a19d6689ab2e5f9b70fcbe9e71df66f241b20a200bd9",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "CDKMetadata": {
            "Type": "AWS::CDK::Metadata",
            "Properties": {
                "Analytics": "v2:deflate64:H4sIAAAAAAAA/21SXY/TMBD8LffuGhok3nM5nTgJcVULvFaOsw3bOnbkXTcKVv47stOkBfE0M7uj/bILWRRbuX1SA210c9kYrGU8sNIXoQY6xma0qnNNLeN3VRsQ1clmMgntWovsZPxB4HfOmZRb+UIqg2D5MTVHJmFUVzfqaF0DZ5LfMrwGqxmdFag6Gfdubphx5wzqMcmZTYI+HaMiAiZZJhAN9MaNHViWz0FfgF/WQHLLOEefFYGYaSp3YzPcuzzqZVgZq5NdZ0yjgO+Q6Ka+qhH8T/BZH9C2Btjd/QuZhOqxVQyDGq+FjF+Y+7LHVCFBkgdWbV59Jim0d4Fn9mYZWq+WGf6Rd18Z+Jfz+Bt8Lr2qSWjjQnPyzrKM7x5btKXWQPTWgGXkvH+VPK/J81/HCxJ7rMPS9lFPk9gDueA1iPwyaQu0ragCsevWXJp25X+ldt5dsQGfn+r2UUy67lENpA3KcqDKYD54KvMeuA88ifSZ5Jk+XItCbj/Lj09nQtz4YBk7kPsZ/wBwUOn58wIAAA=="
            },
            "Metadata": {
                "aws:cdk:path": "AnnotuneStack/CDKMetadata/Default"
            }
        }
    },
    "Outputs": {
        "ExportAnnotuneHttpApiUrl": {
            "Value": {
                "Fn::Join": [
                    "",
                    [
                        "https://",
                        {
                            "Ref": "AnnotuneHttpApiBEB270CD"
                        },
                        ".execute-api.ap-northeast-1.",
                        {
                            "Ref": "AWS::URLSuffix"
                        },
                        "/"
                    ]
                ]
            },
            "Export": {
                "Name": "AnnotuneHttpApiUrl"
            }
        },
        "ExportAnnotuneWebDistributionDomain": {
            "Value": {
                "Fn::GetAtt": [
                    "AnnotuneDistribution14406537",
                    "DomainName"
                ]
            },
            "Export": {
                "Name": "AnnotuneWebDistributionDomain"
            }
        },
        "ExportAnnotuneUserPoolId": {
            "Value": {
                "Ref": "AnnotuneUserPool1679AB31"
            },
            "Export": {
                "Name": "AnnotuneUserPoolId"
            }
        },
        "ExportAnnotuneUserPoolClientId": {
            "Value": {
                "Ref": "AnnotuneUserPoolClient3F26C5A1"
            },
            "Export": {
                "Name": "AnnotuneUserPoolClientId"
            }
        }
    },
    "Parameters": {
        "BootstrapVersion": {
            "Type": "AWS::SSM::Parameter::Value<String>",
            "Default": "/cdk-bootstrap/hnb659fds/version",
            "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
        }
    },
    "Rules": {
        "CheckBootstrapVersion": {
            "Assertions": [
                {
                    "Assert": {
                        "Fn::Not": [
                            {
                                "Fn::Contains": [
                                    [
                                        "1",
                                        "2",
                                        "3",
                                        "4",
                                        "5"
                                    ],
                                    {
                                        "Ref": "BootstrapVersion"
                                    }
                                ]
                            }
                        ]
                    },
                    "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
                }
            ]
        }
    }
}
